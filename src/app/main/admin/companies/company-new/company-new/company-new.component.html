<po-page-edit p-title="Nova Empresa">
    <po-stepper #stepper>
        <po-step p-label="Usuário">
            <!-- [p-can-active-next-step]="formDadosPessoais.invalid" -->
            <po-container>
                <h2 class="po-ml-1 po-mb-3">Dados Pessoais</h2>
                <form [formGroup]="formDadosPessoais">
                    <div class="po-md-12">
                        <po-input
                            formControlName="name"
                            p-auto-focus="true"
                            p-clean="true"
                            p-label="Nome do titular da conta"
                            p-placeholder="Digite o nome"
                            p-required="true"
                            (p-blur)="dirtyMe('name')"
                        >
                        </po-input>
                        <app-invalid-feedback
                            [formCtrl]="formDadosPessoais.get('name')"
                            [hasError]="formDadosPessoais.get('name').errors?.required 
                            && (formDadosPessoais.get('name').dirty)"
                        >
                            Este campo é Obrigatório
                        </app-invalid-feedback>
                    </div>
                    <po-email
                        formControlName="email"
                        class="po-mt-2 po-md-6"
                        p-label="E-mail"
                        p-placeholder="Digite o e-mail"
                        p-error-pattern="Digite um e-mail válido"
                        p-clean
                        p-required
                        p-maxlength="100"
                        p-icon=""
                    ></po-email>
                    <app-invalid-feedback
                        [formCtrl]="formDadosPessoais.get('email')"
                        [hasError]="formDadosPessoais.errors?.isEmailTaken"
                    >
                        Esse e-mail já é utilizado por outro usuário
                    </app-invalid-feedback>
                    <div
                        class="po-row"
                        formGroupName="userExtraData"
                    >
                        <po-input
                            formControlName="cpf"
                            class="po-md-4 po-mt-2"
                            p-label="CPF"
                            p-placeholder="000.000.000-00"
                            p-clean
                            p-mask="999.999.999-99"
                            p-pattern="^[0-9]{11}$"
                            p-error-pattern="Digite um CPF válido"
                        ></po-input>
                    </div>
                    <div formGroupName="userExtraData">
                        <po-input
                            formControlName="phone"
                            class="po-md-3 po-mt-2 po-mb-3"
                            name="phone"
                            p-label="Celular"
                            p-placeholder="(00) 00000-0000"
                            p-clean
                            p-required
                            p-mask="(99) 99999?-9999"
                            p-pattern="^[0-9]{10,11}$"
                            p-error-pattern="Digite um celular válido"
                        ></po-input>
                    </div>
                    <div class="po-row po-ml-1">
                        <po-button
                            [p-disabled]="formDadosPessoais.invalid"
                            p-label="Próximo"
                            p-type="primary"
                            (p-click)="nextForm()"
                        ></po-button>
                    </div>
                </form>
            </po-container>
        </po-step>
        <po-step
            p-label="Empresa"
            [p-can-active-next-step]="formDadosEmpresa.invalid"
        >
            <po-container>
                <h2 class="po-mb-3 po-ml-1">Dados da Empresa </h2>
                <form [formGroup]="formDadosEmpresa">
                    <po-input
                        class="po-sm-3"
                        p-clean="true"
                        p-error-pattern="Digite um CNPJ válido"
                        p-placeholder="00.000.000/0001-00"
                        p-mask="99.999.999/9999-99"
                        p-pattern="^[0-9]{14}$"
                        p-label="CNPJ"
                        name="string"
                        p-required="true"
                        formControlName='cnpj'
                    >
                    </po-input>

                    <po-input
                        class="po-sm-12 po-mt-2"
                        p-clean="true"
                        p-error-pattern="Este campo é obrigatório"
                        p-mask=""
                        p-label="Razão Social"
                        p-placeholder="Digite a razão social"
                        name="string"
                        p-required="true"
                        formControlName='socialReason'
                    >
                    </po-input>

                    <po-input
                        class="po-sm-12 po-mt-2"
                        p-clean="true"
                        p-error-pattern="Este campo é obrigatório"
                        p-placeholder="Digite o nome fantasia"
                        p-mask=""
                        p-label="Nome Fantasia"
                        name="string"
                        p-required="true"
                        formControlName='fantasyName'
                    >
                    </po-input>

                    <po-radio-group
                        class="po-md-12 po-mt-2"
                        name="radioGroupBasic"
                        p-label="Tipo da empresa"
                        [p-options]="[
                            { label: 'Prestadora de Serviço', value: 'SERVICE' },
                            { label: 'Comércio', value: 'COMMERCE' },
                            { label: 'Industria', value: 'INDUSTRY' }
                            ]"
                        formControlName='type'
                    >
                    </po-radio-group>

                    <po-input
                        class="po-md-3 po-mt-2"
                        p-clean="true"
                        p-label="Ramo"
                        p-required="true"
                        p-placeholder="ramo de atuação"
                        formControlName='lineOfBusiness'
                    >
                    </po-input>

                    <po-input
                        class="po-md-9 po-mt-2 po-mb-3"
                        p-clean="true"
                        p-label="CNAE"
                        p-placeholder="Digite o CNAE"
                        p-required="true"
                        formControlName='cnae'
                    >
                    </po-input>

                    <div class="po-row po-ml-1">
                        <h2>Endereço</h2>
                    </div>

                    <po-radio-group
                        class="po-md-12 po-mt-3"
                        name="radioGroupBasic2"
                        p-label="Tipo de Endereço"
                        [p-options]="[
                            { label: 'Comercial', value: 'comercio' },
                            { label: 'Residencial', value: 'redidencial' }

                        ]"
                    >
                    </po-radio-group>
                    <ng-container formGroupName="address">
                        <div class="po-md-3 po-mt-2">
                            <po-input
                                p-label="CEP"
                                p-placeholder="00000-000"
                                p-clean
                                p-required
                                p-mask="99999-999"
                                p-pattern="^[0-9]{8}$"
                                p-error-pattern="Digite um cep válido"
                                formControlName='zipcode'
                            ></po-input>
                            <app-invalid-feedback [hasError]="zipcodeError === true">
                                CEP não encontrado
                            </app-invalid-feedback>
                        </div>

                        <ng-container *ngIf="formDadosEmpresa.get('address.zipcode').valid && zipcodeError !== true">
                            <po-input
                                #streetInput
                                class="po-md-12 po-mt-2"
                                p-label="Logradouro"
                                p-placeholder="Rua, Avenida, Alameda..."
                                p-clean
                                p-required
                                formControlName='street'
                            ></po-input>

                            <po-input
                                #numberInput
                                class="po-md-4 po-mt-2"
                                p-label="Número"
                                p-placeholder="0000"
                                p-clean
                                p-required
                                formControlName='number'
                            ></po-input>

                            <po-input
                                class="po-md-8 po-mt-2"
                                p-label="Complemento"
                                p-placeholder="Ap. 10"
                                p-clean
                                formControlName='complement'
                            ></po-input>

                            <po-input
                                class="po-md-4 po-mt-2"
                                p-label="Bairro"
                                p-placeholder="Digite o bairro"
                                p-clean
                                p-required
                                formControlName='neighborhood'
                            ></po-input>

                            <ng-container formGroupName="city">

                                <po-input
                                    class="po-md-4 po-mt-2"
                                    p-label="Cidade"
                                    p-placeholder="Digite a cidade"
                                    p-required
                                    formControlName='name'
                                ></po-input>

                                <po-input
                                    class="po-md-4 po-mt-2"
                                    p-label="Estado"
                                    p-placeholder="Digite o estado"
                                    p-required
                                    formControlName='stateProvince'
                                ></po-input>

                            </ng-container>
                        </ng-container>
                    </ng-container>
                    <div class="po-row po-ml-1 ">
                        <h2 class="po-mt-3">Contato</h2>
                    </div>
                    <po-email
                        class="po-mt-2 po-md-6"
                        name="email"
                        p-label="E-mail"
                        p-placeholder="Digite o e-mail"
                        p-icon=""
                        p-clean
                        p-required
                        p-maxlength="100"
                        formControlName='email'
                    ></po-email>
                    <po-input
                        class="po-md-3 po-mt-2 po-mb-3"
                        name="phone"
                        p-label="Telefone"
                        p-placeholder="(00) 00000-0000"
                        p-clean
                        p-required
                        p-mask="(99) 99999?-9999"
                        p-pattern="^[0-9]{10,11}$"
                        p-error-pattern="Digite um celular válido"
                        formControlName='phone'
                    ></po-input>
                    <div class="po-row po-ml-1">
                        <po-button
                            [p-disabled]="formDadosEmpresa.invalid"
                            p-label="Finalizar"
                            p-type="primary"
                            (p-click)="submitForm()"
                        ></po-button>
                    </div>
                </form>
            </po-container>
        </po-step>
    </po-stepper>
</po-page-edit>